<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:MoneyMindApp.ViewModels"
             x:Class="MoneyMindApp.Views.EditTransactionPage"
             x:DataType="viewmodels:EditTransactionViewModel"
             Title="Modifica Transazione"
             Shell.NavBarIsVisible="True">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Data -->
            <Border StrokeShape="RoundRectangle 12"
                    Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
                    BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}">
                <VerticalStackLayout Padding="16" Spacing="8">
                    <Label Text="Data" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray300}}" />
                    <DatePicker Date="{Binding TransactionDate}"
                                Format="dd/MM/yyyy"
                                MinimumDate="01/01/2020"
                                MaximumDate="12/31/2030" />
                </VerticalStackLayout>
            </Border>

            <!-- Importo -->
            <Border StrokeShape="RoundRectangle 12"
                    Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
                    BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}">
                <VerticalStackLayout Padding="16" Spacing="8">
                    <Label Text="Importo" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray300}}" />
                    <HorizontalStackLayout Spacing="12">
                        <Entry Text="{Binding Amount}"
                               Placeholder="0.00"
                               Keyboard="Numeric"
                               HorizontalOptions="FillAndExpand"
                               FontSize="20" />
                        <Label Text="â‚¬"
                               FontSize="20"
                               VerticalOptions="Center"
                               TextColor="{StaticResource Primary}" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Border>

            <!-- Tipo (Entrata/Uscita) -->
            <Border StrokeShape="RoundRectangle 12"
                    Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
                    BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}">
                <VerticalStackLayout Padding="16" Spacing="12">
                    <Label Text="Tipo" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray300}}" />
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
                        <Border Grid.Column="0"
                                StrokeShape="RoundRectangle 8"
                                Stroke="{Binding IsIncome, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#4CAF50|#E0E0E0'}"
                                BackgroundColor="{Binding IsIncome, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#4CAF50|Transparent'}">
                            <VerticalStackLayout Padding="12" Spacing="4">
                                <Label Text="ðŸ’°" FontSize="24" HorizontalOptions="Center" />
                                <Label Text="Entrata"
                                       FontSize="14"
                                       FontAttributes="Bold"
                                       TextColor="{Binding IsIncome, Converter={StaticResource BoolToColorConverter}, ConverterParameter='White|{AppThemeBinding Light=Black, Dark=White}'}"
                                       HorizontalOptions="Center" />
                            </VerticalStackLayout>
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SetIncomeCommand}" />
                            </Border.GestureRecognizers>
                        </Border>

                        <Border Grid.Column="1"
                                StrokeShape="RoundRectangle 8"
                                Stroke="{Binding IsIncome, Converter={StaticResource BoolToColorConverter}, ConverterParameter='#E0E0E0|#F44336'}"
                                BackgroundColor="{Binding IsIncome, Converter={StaticResource BoolToColorConverter}, ConverterParameter='Transparent|#F44336'}">
                            <VerticalStackLayout Padding="12" Spacing="4">
                                <Label Text="ðŸ’¸" FontSize="24" HorizontalOptions="Center" />
                                <Label Text="Uscita"
                                       FontSize="14"
                                       FontAttributes="Bold"
                                       TextColor="{Binding IsIncome, Converter={StaticResource BoolToColorConverter}, ConverterParameter='{AppThemeBinding Light=Black, Dark=White}|White'}"
                                       HorizontalOptions="Center" />
                            </VerticalStackLayout>
                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SetExpenseCommand}" />
                            </Border.GestureRecognizers>
                        </Border>
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- Descrizione -->
            <Border StrokeShape="RoundRectangle 12"
                    Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
                    BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}">
                <VerticalStackLayout Padding="16" Spacing="8">
                    <Label Text="Descrizione" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray300}}" />
                    <Entry Text="{Binding Description}"
                           Placeholder="es. Spesa supermercato"
                           MaxLength="200" />
                </VerticalStackLayout>
            </Border>

            <!-- Causale -->
            <Border StrokeShape="RoundRectangle 12"
                    Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray600}}"
                    BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}">
                <VerticalStackLayout Padding="16" Spacing="8">
                    <Label Text="Causale (opzionale)" FontSize="12" TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray300}}" />
                    <Entry Text="{Binding Reason}"
                           Placeholder="es. Alimentari"
                           MaxLength="100" />
                </VerticalStackLayout>
            </Border>

            <!-- Buttons -->
            <Grid ColumnDefinitions="*,*,*" ColumnSpacing="12" Margin="0,20,0,0">
                <Button Grid.Column="0"
                        Text="Annulla"
                        Command="{Binding CancelCommand}"
                        BackgroundColor="{StaticResource Gray300}"
                        TextColor="{StaticResource Gray900}" />

                <Button Grid.Column="1"
                        Text="Elimina"
                        Command="{Binding DeleteCommand}"
                        BackgroundColor="#F44336"
                        TextColor="White" />

                <Button Grid.Column="2"
                        Text="Salva"
                        Command="{Binding SaveCommand}"
                        BackgroundColor="{StaticResource Primary}"
                        TextColor="White" />
            </Grid>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
